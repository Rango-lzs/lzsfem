#include "FEHex8Shape.h"

//=============================================================================
//                                 H E X 8
//=============================================================================

//-----------------------------------------------------------------------------
void FEHex8::shape_fnc(double* H, double r, double s, double t)
{
	H[0] = 0.125*(1 - r)*(1 - s)*(1 - t);
	H[1] = 0.125*(1 + r)*(1 - s)*(1 - t);
	H[2] = 0.125*(1 + r)*(1 + s)*(1 - t);
	H[3] = 0.125*(1 - r)*(1 + s)*(1 - t);
	H[4] = 0.125*(1 - r)*(1 - s)*(1 + t);
	H[5] = 0.125*(1 + r)*(1 - s)*(1 + t);
	H[6] = 0.125*(1 + r)*(1 + s)*(1 + t);
	H[7] = 0.125*(1 - r)*(1 + s)*(1 + t);
}

//-----------------------------------------------------------------------------
//! values of shape function derivatives
void FEHex8::shape_deriv(double* Hr, double* Hs, double* Ht, double r, double s, double t)
{
	Hr[0] = -0.125*(1 - s)*(1 - t);
	Hr[1] = 0.125*(1 - s)*(1 - t);
	Hr[2] = 0.125*(1 + s)*(1 - t);
	Hr[3] = -0.125*(1 + s)*(1 - t);
	Hr[4] = -0.125*(1 - s)*(1 + t);
	Hr[5] = 0.125*(1 - s)*(1 + t);
	Hr[6] = 0.125*(1 + s)*(1 + t);
	Hr[7] = -0.125*(1 + s)*(1 + t);

	Hs[0] = -0.125*(1 - r)*(1 - t);
	Hs[1] = -0.125*(1 + r)*(1 - t);
	Hs[2] = 0.125*(1 + r)*(1 - t);
	Hs[3] = 0.125*(1 - r)*(1 - t);
	Hs[4] = -0.125*(1 - r)*(1 + t);
	Hs[5] = -0.125*(1 + r)*(1 + t);
	Hs[6] = 0.125*(1 + r)*(1 + t);
	Hs[7] = 0.125*(1 - r)*(1 + t);

	Ht[0] = -0.125*(1 - r)*(1 - s);
	Ht[1] = -0.125*(1 + r)*(1 - s);
	Ht[2] = -0.125*(1 + r)*(1 + s);
	Ht[3] = -0.125*(1 - r)*(1 + s);
	Ht[4] = 0.125*(1 - r)*(1 - s);
	Ht[5] = 0.125*(1 + r)*(1 - s);
	Ht[6] = 0.125*(1 + r)*(1 + s);
	Ht[7] = 0.125*(1 - r)*(1 + s);
}

//-----------------------------------------------------------------------------
//! values of shape function second derivatives
void FEHex8::shape_deriv2(double* Hrr, double* Hss, double* Htt, double* Hrs, double* Hst, double* Hrt, double r, double s, double t)
{
	Hrr[0] = 0.0; Hss[0] = 0.0; Htt[0] = 0.0;
	Hrr[1] = 0.0; Hss[1] = 0.0; Htt[1] = 0.0;
	Hrr[2] = 0.0; Hss[2] = 0.0; Htt[2] = 0.0;
	Hrr[3] = 0.0; Hss[3] = 0.0; Htt[3] = 0.0;
	Hrr[4] = 0.0; Hss[4] = 0.0; Htt[4] = 0.0;
	Hrr[5] = 0.0; Hss[5] = 0.0; Htt[5] = 0.0;
	Hrr[6] = 0.0; Hss[6] = 0.0; Htt[6] = 0.0;
	Hrr[7] = 0.0; Hss[7] = 0.0; Htt[7] = 0.0;

	Hrs[0] = 0.125*(1 - t);
	Hrs[1] = -0.125*(1 - t);
	Hrs[2] = 0.125*(1 - t);
	Hrs[3] = -0.125*(1 - t);
	Hrs[4] = 0.125*(1 + t);
	Hrs[5] = -0.125*(1 + t);
	Hrs[6] = 0.125*(1 + t);
	Hrs[7] = -0.125*(1 + t);

	Hrt[0] = 0.125*(1 - s);
	Hrt[1] = -0.125*(1 - s);
	Hrt[2] = -0.125*(1 + s);
	Hrt[3] = 0.125*(1 + s);
	Hrt[4] = -0.125*(1 - s);
	Hrt[5] = 0.125*(1 - s);
	Hrt[6] = 0.125*(1 + s);
	Hrt[7] = -0.125*(1 + s);

	Hst[0] = 0.125*(1 - r);
	Hst[1] = 0.125*(1 + r);
	Hst[2] = -0.125*(1 + r);
	Hst[3] = -0.125*(1 - r);
	Hst[4] = -0.125*(1 - r);
	Hst[5] = -0.125*(1 + r);
	Hst[6] = 0.125*(1 + r);
	Hst[7] = 0.125*(1 - r);
}