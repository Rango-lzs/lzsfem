/*********************************************************************
 * \file   MaterialConversion_Integration_Checklist.txt
 * \brief  Step-by-step checklist for integrating material conversion
 *
 * \date   February 2026
 *********************************************************************/

MATERIAL CONVERSION INTEGRATION CHECKLIST
==========================================

This checklist helps you integrate the Abaqus material conversion
functionality into your FE solver step by step.

□ STEP 1: Copy New Files
   ├─ Copy AbaqusMaterialConverter.h to your project (e.g., femcore/)
   ├─ Copy AbaqusMaterialConverter.cpp to your project
   └─ Add to build system (CMakeLists.txt, Makefile, etc.)

□ STEP 2: Update AbaqusImport.h
   Add to private section:
   ```cpp
   private:
       bool createMaterials(FEModel* fem);
   ```

□ STEP 3: Update AbaqusImport.cpp - Add Includes
   Add at the top:
   ```cpp
   #include "AbaqusMaterialConverter.h"
   ```

□ STEP 4: Update AbaqusImport.cpp - Replace parseMaterial
   Replace the existing parseMaterial function with the version from
   AbaqusImport_MaterialUpdate.cpp (lines 19-193)
   
   Key changes:
   ├─ Handles *PLASTIC keyword
   ├─ Better logging
   ├─ Improved error handling
   └─ Material type detection (ELASTIC vs PLASTIC)

□ STEP 5: Update AbaqusImport.cpp - Add createMaterials Function
   Add the createMaterials function from AbaqusImport_MaterialUpdate.cpp
   (lines 199-257)
   
   This function:
   ├─ Converts parsed materials to FEModel materials
   ├─ Uses AbaqusMaterialConverter
   └─ Adds materials to FEModel

□ STEP 6: Update processData Function
   In processData(), add BEFORE geometry processing:
   ```cpp
   // 1. Create materials FIRST
   if (!createMaterials(fem))
   {
       RgLogError("Failed to create materials");
       return false;
   }
   ```

□ STEP 7: Optional - Update RgMaterial Base Class
   If needed, add to RgMaterial class:
   ```cpp
   void SetName(const std::string& name);
   std::string GetName() const;
   void SetID(int id);
   int GetID() const;
   void SetDensity(double rho);  // If not already present
   ```

□ STEP 8: Test with Simple INP File
   Create test.inp:
   ```
   *Material, name=Steel
   *Elastic
   210000, 0.3
   *Density
   7850
   ```
   
   Expected console output:
   ```
   Parsing material: Steel
     Elastic: E=210000, nu=0.3
     Density: 7850
   Converting material: Steel
     Created linear elastic material: E=210000, nu=0.3
   ```

□ STEP 9: Test with Plastic Material
   Create test_plastic.inp:
   ```
   *Material, name=Aluminum
   *Elastic
   70000, 0.33
   *Plastic
   250, 0.0
   350, 0.1
   *Density
   2700
   ```
   
   Expected output:
   ```
   Parsing material: Aluminum
     Elastic: E=70000, nu=0.33
     Plastic: 2 hardening points
       Initial yield: 250 at eps_p = 0
     Density: 2700
   Converting material: Aluminum
     Created elasto-plastic material: E=70000, nu=0.33, sy=250, H=1000
   ```

□ STEP 10: Verify Material Assignment (Future)
   Plan for section-based material assignment:
   ├─ Parse *SOLID SECTION / *SHELL SECTION
   ├─ Store ELSET->MATERIAL mapping
   └─ Assign materials to domains during createDomain()


VERIFICATION TESTS
==================

□ Test 1: Linear Elastic Material
   Input:  *Elastic with E, nu
   Output: RgLinearElastic created
   Check:  Material added to FEModel

□ Test 2: Elasto-Plastic Material  
   Input:  *Elastic + *Plastic
   Output: RgElastoPlastic created
   Check:  Hardening modulus calculated correctly

□ Test 3: Missing Elastic Properties
   Input:  *Plastic only (no *Elastic)
   Output: Error message, material not created
   Check:  Graceful error handling

□ Test 4: Invalid Material Properties
   Input:  E < 0 or nu >= 0.5
   Output: Error message with bounds
   Check:  Validation works

□ Test 5: Multiple Materials
   Input:  Several *Material blocks
   Output: All materials created
   Check:  Material count matches


COMMON ISSUES & SOLUTIONS
==========================

Issue: Compilation error - "RgLinearElastic not found"
Solution: Check includes and namespace (SmallDef::RgLinearElastic)

Issue: Linker error - undefined reference to AbaqusMaterialConverter
Solution: Add AbaqusMaterialConverter.cpp to build system

Issue: Material created but density is 0
Solution: Add SetDensity() call in converter (may need to add to RgMaterial)

Issue: Materials created but not assigned to elements
Solution: Implement section parsing and material-domain assignment

Issue: Segmentation fault in createMaterials
Solution: Check FEModel pointer is valid before calling AddMaterial


IMPLEMENTATION NOTES
====================

1. Material Order:
   Materials are created in the order they appear in the INP file.
   Material ID = index + 1 (1-based indexing).

2. Material Naming:
   Material names from Abaqus are preserved.
   Can be used to find materials: fem->FindMaterial("Steel")

3. Hardening Calculation:
   Linear hardening modulus H is calculated from first two plastic points:
   H = (stress2 - stress1) / (plastic_strain2 - plastic_strain1)
   
   For perfectly plastic (single point or H=0):
   Only yield stress is used, H = 0

4. Unit System:
   Ensure consistency between Abaqus and FEModel:
   - Abaqus default: N, mm, tonne, s
   - Your solver: ? (document here)

5. Material Types Not Yet Supported:
   - Hyperelastic (Neo-Hookean, Mooney-Rivlin)
   - Temperature-dependent properties
   - Anisotropic materials
   - User materials (UMAT)
   - Viscoelastic materials
   - Concrete/damage models


FILES CREATED
=============

1. AbaqusMaterialConverter.h
   Purpose: Material conversion interface
   Size: ~80 lines
   Dependencies: RgMaterial.h, FEModel.h

2. AbaqusMaterialConverter.cpp
   Purpose: Material conversion implementation
   Size: ~200 lines
   Dependencies: RgLinearElasticMaterial.h, RgElastoPlasticMaterial.h

3. AbaqusImport_MaterialUpdate.cpp
   Purpose: Updated parsing and processing functions (reference)
   Size: ~250 lines
   Usage: Copy functions to AbaqusImport.cpp

4. AbaqusMaterialConversion_README.md
   Purpose: Detailed usage guide
   Size: ~300 lines
   Usage: Developer documentation

5. MaterialConversion_Integration_Checklist.txt (this file)
   Purpose: Integration checklist
   Usage: Follow step by step


NEXT STEPS
==========

After completing this checklist:

1. □ Implement section parsing (*SOLID SECTION, *SHELL SECTION)
2. □ Map materials to domains via element sets
3. □ Test with real-world Abaqus models
4. □ Add support for additional material types as needed
5. □ Document any custom material models in your solver


COMPLETION SIGN-OFF
===================

When all steps are complete:

Date: ___________
Tested by: ___________
Verified by: ___________

Notes:
_______________________________________________________________
_______________________________________________________________
_______________________________________________________________
